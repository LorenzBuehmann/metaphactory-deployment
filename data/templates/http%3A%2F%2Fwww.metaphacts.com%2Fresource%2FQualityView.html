<!-- Trigger -->
<button id="recomputeAndValidate" class="btn btn-primary">Recompute & validate</button>

<!-- 1) Button click → SPARQL UPDATE (re)builds helper triples -->
<mp-event-proxy
  on-event-source="recomputeAndValidate"
  on-event-type="click"
  proxy-event-type="SemanticUpdate.Execute"
  proxy-targets='["update-archived-helpers"]'>
</mp-event-proxy>

<semantic-update
  id="update-archived-helpers"
  show-confirmation="false"
  redirect="event"
  query="
PREFIX owl:  <http://www.w3.org/2002/07/owl#>
PREFIX bibo: <http://purl.org/ontology/bibo/>
PREFIX pso:  <http://purl.org/spar/pso/>
PREFIX qa:   <urn:qa:>

DELETE { GRAPH ?g { <{{iri}}> qa:importsArchived ?o . } }
INSERT { GRAPH ?g { <{{iri}}> qa:importsArchived ?o . } }
WHERE  {
  BIND(IRI('{{iri}}') AS ?this)
  BIND(?this AS ?g)  # adjust if graph IRI ≠ ontology IRI
  GRAPH ?g { ?this a owl:Ontology ; owl:imports ?o . }
  GRAPH ?o { ?o bibo:status pso:archived . }
}">
</semantic-update>

